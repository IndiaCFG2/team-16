<!doctype html>
<html lang="en">
  <head>
    <title>User Donation</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- Material Kit CSS -->
    <link href="assets/css/material-kit.css?v=2.2.0" rel="stylesheet" />
    <link herf="css/userDonation.css" rel="stylesheet" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg bg-primary">
      <div class="container">
        <a class="navbar-brand" href="#">Navbar</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="navbar-toggler-icon"></span>
        <span class="navbar-toggler-icon"></span>
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Features</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Pricing</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#">Disabled</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <div class="row">
        <div class="col-md-10 ml-auto mr-auto">
          <div class="card card-signup">
            <h2 class="card-title text-center">Donate Item</h2>
            <div class="card-body">
              <div class="row">
                <div class="col-md-10 ml-auto mr-auto">
                
                <form method="POST" enctype='multipart/form-data'>

                  <div class="form-group col-md-12">
                    <select id="inputState" class="form-control">
                      <option selected>Choose Item Type</option>
                      <option>Clothing</option>
                      <option>Electronics</option>
                      <option>Books</option>
                      <option>Others</option>
                    </select>
                   
                  </div>

                  <div class="form-group col-md-12" style="margin-top: -20px ;">
                    <input type="text" id="item_name" name="item_name" class="form-control"placeholder="Item Name" />
                    
                  </div>

                  <div class="form-group col-md-12">
                    <label for="years_old" style="margin-left: 16px;">How Old is your Item ?</label>

                    <!-- Donation is how many years old input -->
                    <input type="number" min="0" name="years_old" id="years_old" class="form-control"  />
                    


                  </div>

                  <div class="form-group col-md-12">
                    <label for="quality_rating" style="margin-left: 16px;">Out of 5 what would you rate product quality?</label>

                    <!-- Quality rating input-->
                    <input type="number" min="1" max="5" name="quality_rating" id="quality_rating" class="form-control"  />
                    
                  </div>

                  <!-- Quick Fix Center Tag-->
                <center>
                  <div class="form-group col-md-12">
                    <label for="donate_desc" style="margin-left: 16px;">Description of Donation</label>
                    <textarea class="form-control" id="donate_desc" rows="4"></textarea>
                  </div>

                  <div class="fileinput fileinput-new text-center" data-provides="fileinput">
                    <div class="fileinput-new thumbnail img-raised">
                        <img src="http://style.anu.edu.au/_anu/4/images/placeholders/person_8x10.png" alt="...">
                    </div>
                    <div class="fileinput-preview fileinput-exists thumbnail img-raised"></div>
                    <div>
                        <span class="btn btn-raised btn-round btn-default btn-file">
                            <span class="fileinput-new">Select Item Image</span>
                            <span class="fileinput-exists">Change</span>

                          <!-- File Input -->
                            <input type="file" id="file" name="donation_image" />
                            

                        </span>
                        <a href="#pablo" class="btn btn-danger btn-round fileinput-exists" data-dismiss="fileinput"><i class="fa fa-times"></i> Remove</a>
                    </div>
                </div><br>
              </center>

              <!-- Quick Fix Center Tag -->
                <center>
                <button type="submit" class="btn btn-primary" id="submit">Submit</button><br>
                <span class="error" style="font-size:12px;color:red;"></span>
              </center>


                </form>
                  

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

<footer class="footer footer-default" >
  <div class="container">
    <nav class="float-left">
      <ul>
        <li>
          <a href="https://www.creative-tim.com/">
              Team Meraki
          </a>
        </li>
      </ul>
    </nav>
    <div class="copyright float-right">
        &copy;
        <script>
            document.write(new Date().getFullYear())
        </script>, made with <i class="material-icons">favorite</i> by
        <a href="https://www.creative-tim.com/" target="blank">Creative Tim</a> for a better web.
    </div>
  </div>
</footer>
<!--   Core JS Files   -->
<script src="assets/js/core/jquery.min.js" type="text/javascript"></script>
<script src="assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
<script src="assets/js/plugins/moment.min.js"></script>
<!--	Plugin for the Datepicker, full documentation here: https://github.com/Eonasdan/bootstrap-datetimepicker -->
<script src="assets/js/plugins/bootstrap-datetimepicker.js" type="text/javascript"></script>
<!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
<script src="assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
<!--  Google Maps Plugin  -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
<!--	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
<script src="assets/js/plugins/bootstrap-tagsinput.js"></script>
<!--	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
<script src="assets/js/plugins/bootstrap-selectpicker.js" type="text/javascript"></script>
<!--	Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
<script src="assets/js/plugins/jasny-bootstrap.min.js" type="text/javascript"></script>
<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
<!-- Control Center for Material Kit: parallax effects, scripts for the example pages etc -->
<script src="assets/js/material-kit.js?v=2.2.0" type="text/javascript"></script>
<script type="text/javascript">

$("#submit").click(function(e){

  e.preventDefault();
  $(".error").html("");
  var item_name = $("#item_name").val().trim();
  var years_old = $("#years_old").val().trim();
  var quality_rating = $("#quality_rating").val().trim();
  var donate_desc = $("#donate_desc").val().trim();
  var item_type = $("#inputState").val().trim();
  var file_data = $('input[type="file"]')[0].files;


  //console.log(file_data[0]["name"]+file_data[0]["type"]);

  
  var error = 0 ;
  var error_string = "";

  if(item_type=="Choose Item Type"){
    error = 1;
    error_string += "Please Choose an item type!<br>";
  }

  if(item_name==""){
    error = 1;
    error_string += "Item field can not be empty!<br>";
  }

  if(years_old==""){
    error = 1;
    error_string += "Please specify how many years old is item!<br>";
  }

  if(quality_rating==""){
    error = 1;
    error_string += "Quality Rating can not be empty<br>";
  }

  if(donate_desc==""){
    error = 1;
    error_string += "Donation Description can not be empty<br>";
  }

  if(file_data[0]==undefined){
    error = 1;
    error_string += "Please select an image of your donation!<br>";
  }else{
    var file_type = file_data[0]["type"];
    if(file_type.substring(0,5)!="image"){
      error = 1;
    error_string += "Please upload an image file only!<br>";
    }
  }

  


  if(error == 1){
    $(".error").html("<b>The following error(s) were found:</b> <br>"+error_string);
  }else{

    var formData = new FormData();
    
// var data =  {
//               "item_name":item_name,
//               "item_type":item_type,
//               "years_old":years_old,
//               "donate_desc":donate_desc,
//               "quality_rating":quality_rating,
//               "file" : file_data[0]
//             };  


            console.log(data);  

    $.ajax({
            url: 'addProduct.php',
            type: 'POST',
            data: {
              "item_name":item_name,
              "item_type":item_type,
              "years_old":years_old,
              "donate_desc":donate_desc,
              "quality_rating":quality_rating,
              "file" : file_data[0]
            },
            async: false,
            cache: false,
            contentType: false,
            processData: false,
            success: function () {
                alert('Form Submitted!');
            },
            error: function(){
                alert("error in ajax form submission");
            }
        });

  }

  



})

</script>
</body>
</html>